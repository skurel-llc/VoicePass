generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model vp_user {
  id               Int               @id @default(autoincrement())
  email            String?           @unique @db.VarChar(255)
  password         String?           @db.VarChar(255)
  name             String?           @db.VarChar(255)
  role             String?           @default("user") @db.VarChar(50)
  company          String?           @db.VarChar(255)
  phone            String?           @db.VarChar(50)
  balance          Float?            @default(0)
  is_active        Boolean?          @default(true)
  api_key          String?           @db.VarChar(255)
  last_bal_updated DateTime?         @updatedAt @db.Timestamp(6)
  call_logs        vp_call_log[]
  vp_transactions  vp_transactions[]
}

model vp_call_log {
  id           Int      @id @default(autoincrement())
  user_id      Int?
  call_id      String?  @db.VarChar(255)
  gender       String?  @db.VarChar(50)
  cost         Float?
  language     String?  @db.VarChar(100)
  phone_number String?  @db.VarChar(50)
  otp          String?  @db.VarChar(50)
  status       String?  @db.VarChar(100)
  duration     String?  @db.VarChar(50)
  created_at   String?  @db.VarChar(100)
  start_time   String?  @db.VarChar(100)
  answer_time  String?  @db.VarChar(100)
  ring_time    String?  @db.VarChar(100)
  end_at       String?  @db.VarChar(100)
  callback_url String?
  webhook_sent String?  @db.VarChar(100)
  user         vp_user? @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model vp_transactions {
  id             Int       @id @default(autoincrement())
  user_id        Int?
  type           String?   @default("DEBIT") @db.VarChar(50)
  amount         Float?
  balance_before Float?
  description    String?
  reference      String?   @db.VarChar(255)
  created_at     DateTime? @default(now()) @db.Timestamp(6)
  vp_user        vp_user?  @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}
